{"map":"{\"version\":3,\"sources\":[\"webpack/bootstrap\",\"external \\\"express-jwt\\\"\",\"external \\\"body-parser\\\"\",\"external \\\"express\\\"\",\"external \\\"compression\\\"\",\"external \\\"helmet\\\"\",\"external \\\"pretty-error\\\"\",\"external \\\"cookie-parser\\\"\",\"external \\\"path\\\"\",\"C:\\\\0bot\\\\chinese_duck/src\\\\server\\\\config.js\",\"C:\\\\0bot\\\\chinese_duck/src\\\\server\\\\index.js\",\"external \\\"@babel/polyfill/noConflict\\\"\"],\"names\":[\"installedModules\",\"__webpack_require__\",\"moduleId\",\"exports\",\"module\",\"i\",\"l\",\"modules\",\"call\",\"m\",\"c\",\"d\",\"name\",\"getter\",\"o\",\"Object\",\"defineProperty\",\"configurable\",\"enumerable\",\"get\",\"r\",\"value\",\"n\",\"__esModule\",\"object\",\"property\",\"prototype\",\"hasOwnProperty\",\"p\",\"s\",\"require\",\"port\",\"process\",\"env\",\"PORT\",\"config\",\"api\",\"clientUrl\",\"API_CLIENT_URL\",\"serverUrl\",\"API_SERVER_URL\",\"concat\",\"databaseUrl\",\"DATABASE_URL\",\"auth\",\"jwt\",\"secret\",\"JWT_SECRET\",\"app\",\"external_express_default\",\"use\",\"external_cookie_parser_default\",\"external_body_parser_default\",\"a\",\"urlencoded\",\"extended\",\"json\",\"external_helmet_default\",\"external_compression_default\",\"external_express_jwt_default\",\"credentialsRequired\",\"getToken\",\"req\",\"cookies\",\"id_token\",\"err\",\"res\",\"next\",\"external_express_jwt_\",\"console\",\"error\",\"clearCookie\",\"static\",\"external_path_default\",\"join\",\"__dirname\",\"redirect\",\"pe\",\"external_pretty_error_default\",\"skipNodeFiles\",\"skipPackage\",\"listen\",\"info\",\"__webpack_exports__\"],\"mappings\":\"oDACA,IAAAA,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAC,QAGA,IAAAC,EAAAJ,EAAAE,IACAG,EAAAH,EACAI,GAAA,EACAH,YAUA,OANAI,EAAAL,GAAAM,KAAAJ,EAAAD,QAAAC,EAAAA,EAAAD,QAAAF,GAGAG,EAAAE,GAAA,EAGAF,EAAAD,QAKAF,EAAAQ,EAAAF,EAGAN,EAAAS,EAAAV,EAGAC,EAAAU,EAAA,SAAAR,EAAAS,EAAAC,GACAZ,EAAAa,EAAAX,EAAAS,IACAG,OAAAC,eAAAb,EAAAS,GACAK,cAAA,EACAC,YAAA,EACAC,IAAAN,KAMAZ,EAAAmB,EAAA,SAAAjB,GACAY,OAAAC,eAAAb,EAAA,cAAiDkB,OAAA,KAIjDpB,EAAAqB,EAAA,SAAAlB,GACA,IAAAS,EAAAT,GAAAA,EAAAmB,WACA,WAA2B,OAAAnB,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAH,EAAAU,EAAAE,EAAA,IAAAA,GACAA,GAIAZ,EAAAa,EAAA,SAAAU,EAAAC,GAAsD,OAAAV,OAAAW,UAAAC,eAAAnB,KAAAgB,EAAAC,IAGtDxB,EAAA2B,EAAA,WAIA3B,EAAAA,EAAA4B,EAAA,oBCnEAzB,EAAAD,QAAA2B,QAAA,8BCAA1B,EAAAD,QAAA2B,QAAA,8BCAA1B,EAAAD,QAAA2B,QAAA,0BCAA1B,EAAAD,QAAA2B,QAAA,8BCAA1B,EAAAD,QAAA2B,QAAA,yBCAA1B,EAAAD,QAAA2B,QAAA,+BCAA1B,EAAAD,QAAA2B,QAAA,gCCAA1B,EAAAD,QAAA2B,QAAA,iJCMA,IAAMC,EAAOC,QAAQC,IAAIC,MAAQ,IAiBjCC,GAdEJ,KAAAA,EACAK,KACEC,UAAWL,QAAQC,IAAIK,gBAAkB,GACzCC,UACEP,QAAQC,IAAIO,gBAAZ,oBAAAC,OACoBV,IAGxBW,YAAaV,QAAQC,IAAIU,cAAgB,kBACzCC,MACEC,KAAOC,OAAQd,QAAQC,IAAIc,YAAc,yDCNvCC,EAAMC,GAAAA,GAGZD,EAAIE,IAAIC,GAAAA,IACRH,EAAIE,IAAIE,EAAAC,EAAWC,YAAaC,UAAU,KAC1CP,EAAIE,IAAIE,EAAAC,EAAWG,QACnBR,EAAIE,IAAIO,GAAAA,IACRT,EAAIE,IAAIQ,GAAAA,IAGRV,EAAIE,IACFS,GAAAA,EACEb,OAAQX,EAAOS,KAAKC,IAAIC,OACxBc,qBAAqB,EACrBC,SAAU,SAAAC,GAAA,OAAOA,EAAIC,QAAQC,aAIjChB,EAAIE,IAAI,SAACe,EAAKH,EAAKI,EAAKC,GAElBF,aAAeG,EAAA,oBACjBC,QAAQC,MAAM,sBAAuBR,EAAIC,QAAQC,UAEjDE,EAAIK,YAAY,aAElBJ,EAAKF,KA2BPjB,EAAIE,IAAI,UAAWD,EAAAI,EAAQmB,OAAOC,EAAApB,EAAKqB,KAAKC,UAAW,aACvD3B,EAAI7B,IAAI,IAAK,SAAS2C,EAAKI,GACzBA,EAAIU,SAAS,aAef,IAAMC,EAAK,IAAIC,EAAAzB,EACfwB,EAAGE,gBACHF,EAAGG,YAAY,WASfhC,EAAIiC,OAAO9C,EAAOJ,KAAM,WACtBsC,QAAQa,KAAR,6CAAAzC,OAA0DN,EAAOJ,KAAjE,QAEFoD,EAAA,QAAA,iBChGA/E,EAAAD,QAAA2B,QAAA\",\"sourcesContent\":[\" \\t// The module cache\\n \\tvar installedModules = {};\\n\\n \\t// The require function\\n \\tfunction __webpack_require__(moduleId) {\\n\\n \\t\\t// Check if module is in cache\\n \\t\\tif(installedModules[moduleId]) {\\n \\t\\t\\treturn installedModules[moduleId].exports;\\n \\t\\t}\\n \\t\\t// Create a new module (and put it into the cache)\\n \\t\\tvar module = installedModules[moduleId] = {\\n \\t\\t\\ti: moduleId,\\n \\t\\t\\tl: false,\\n \\t\\t\\texports: {}\\n \\t\\t};\\n\\n \\t\\t// Execute the module function\\n \\t\\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\\n\\n \\t\\t// Flag the module as loaded\\n \\t\\tmodule.l = true;\\n\\n \\t\\t// Return the exports of the module\\n \\t\\treturn module.exports;\\n \\t}\\n\\n\\n \\t// expose the modules object (__webpack_modules__)\\n \\t__webpack_require__.m = modules;\\n\\n \\t// expose the module cache\\n \\t__webpack_require__.c = installedModules;\\n\\n \\t// define getter function for harmony exports\\n \\t__webpack_require__.d = function(exports, name, getter) {\\n \\t\\tif(!__webpack_require__.o(exports, name)) {\\n \\t\\t\\tObject.defineProperty(exports, name, {\\n \\t\\t\\t\\tconfigurable: false,\\n \\t\\t\\t\\tenumerable: true,\\n \\t\\t\\t\\tget: getter\\n \\t\\t\\t});\\n \\t\\t}\\n \\t};\\n\\n \\t// define __esModule on exports\\n \\t__webpack_require__.r = function(exports) {\\n \\t\\tObject.defineProperty(exports, '__esModule', { value: true });\\n \\t};\\n\\n \\t// getDefaultExport function for compatibility with non-harmony modules\\n \\t__webpack_require__.n = function(module) {\\n \\t\\tvar getter = module && module.__esModule ?\\n \\t\\t\\tfunction getDefault() { return module['default']; } :\\n \\t\\t\\tfunction getModuleExports() { return module; };\\n \\t\\t__webpack_require__.d(getter, 'a', getter);\\n \\t\\treturn getter;\\n \\t};\\n\\n \\t// Object.prototype.hasOwnProperty.call\\n \\t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\\n\\n \\t// __webpack_public_path__\\n \\t__webpack_require__.p = \\\"/client/\\\";\\n\\n\\n \\t// Load entry module and return exports\\n \\treturn __webpack_require__(__webpack_require__.s = 10);\\n\",\"module.exports = require(\\\"express-jwt\\\");\",\"module.exports = require(\\\"body-parser\\\");\",\"module.exports = require(\\\"express\\\");\",\"module.exports = require(\\\"compression\\\");\",\"module.exports = require(\\\"helmet\\\");\",\"module.exports = require(\\\"pretty-error\\\");\",\"module.exports = require(\\\"cookie-parser\\\");\",\"module.exports = require(\\\"path\\\");\",\"if (process.env.BROWSER) {\\n  throw new Error(\\n    'Do not import `config.js` from inside the client-side code.'\\n  );\\n}\\n\\nconst port = process.env.PORT || 8000;\\n\\nconst nodeJsApp = {\\n  port,\\n  api: {\\n    clientUrl: process.env.API_CLIENT_URL || '',\\n    serverUrl:\\n      process.env.API_SERVER_URL ||\\n      `http://localhost:${port}`,\\n  },\\n\\n  databaseUrl: process.env.DATABASE_URL || 'localhost:27017',\\n  auth: {\\n    jwt: { secret: process.env.JWT_SECRET || 'No secrets from you' },\\n  },\\n};\\n\\nexport default nodeJsApp;\\n\",\"import path from 'path';\\r\\nimport express from 'express';\\r\\nimport cookieParser from 'cookie-parser';\\r\\nimport bodyParser from 'body-parser';\\r\\nimport expressJwt, { UnauthorizedError as Jwt401Error } from 'express-jwt';\\r\\n//import jwt from 'jsonwebtoken';\\r\\nimport PrettyError from 'pretty-error';\\r\\n//import passport from './passport';\\r\\n//import router from './router';\\r\\nimport config from './config';\\r\\nimport helmet from 'helmet';\\r\\nimport compression from 'compression';\\r\\n\\r\\nconst app = express();\\r\\n\\r\\n// Register Node.js middleware\\r\\napp.use(cookieParser());\\r\\napp.use(bodyParser.urlencoded({ extended: true }));\\r\\napp.use(bodyParser.json());\\r\\napp.use(helmet());\\r\\napp.use(compression());\\r\\n\\r\\n// Authentication\\r\\napp.use(\\r\\n  expressJwt({\\r\\n    secret: config.auth.jwt.secret,\\r\\n    credentialsRequired: false,\\r\\n    getToken: req => req.cookies.id_token,\\r\\n  }),\\r\\n);\\r\\n// Error handler for express-jwt\\r\\napp.use((err, req, res, next) => {\\r\\n  // eslint-disable-line no-unused-vars\\r\\n  if (err instanceof Jwt401Error) {\\r\\n    console.error('[express-jwt-error]', req.cookies.id_token);\\r\\n    // `clearCookie`, otherwise user can't use web-app until cookie expires\\r\\n    res.clearCookie('id_token');\\r\\n  }\\r\\n  next(err);\\r\\n});\\r\\n\\r\\n//app.use(passport.initialize());\\r\\n\\r\\n// app.get(\\r\\n//   '/login/facebook',\\r\\n//   passport.authenticate('facebook', {\\r\\n//     scope: ['email', 'user_location'],\\r\\n//     session: false,\\r\\n//   }),\\r\\n// );\\r\\n\\r\\n// app.get(\\r\\n//   '/login/facebook/return',\\r\\n//   passport.authenticate('facebook', {\\r\\n//     failureRedirect: '/login',\\r\\n//     session: false,\\r\\n//   }),\\r\\n//   (req, res) => {\\r\\n//     const expiresIn = 60 * 60 * 24 * 180; // 180 days\\r\\n//     const token = jwt.sign(req.user, config.auth.jwt.secret, { expiresIn });\\r\\n//     res.cookie('id_token', token, { maxAge: 1000 * expiresIn, httpOnly: true });\\r\\n//     res.redirect('/');\\r\\n//   },\\r\\n// );\\r\\n\\r\\napp.use(\\\"/client\\\", express.static(path.join(__dirname, \\\"/public\\\")));\\r\\napp.get('/', function(req, res) {\\r\\n  res.redirect('/client');\\r\\n});\\r\\n\\r\\n//app.get(\\\"*\\\", (req, res) => res.sendFile(HTML_FILE));\\r\\n\\r\\n// // Register server-side rendering middleware\\r\\n// app.get('/public', async (req, res, next) => {\\r\\n//   try {\\r\\n//     next();\\r\\n//   } catch (err) {\\r\\n//     next(err);\\r\\n//   }\\r\\n// });\\r\\n\\r\\n// Error handling\\r\\nconst pe = new PrettyError();\\r\\npe.skipNodeFiles();\\r\\npe.skipPackage('express');\\r\\n\\r\\n// Hot Module Replacement\\r\\n// -----------------------------------------------------------------------------\\r\\nif (module.hot) {\\r\\n  app.hot = module.hot;\\r\\n  module.hot.accept();\\r\\n}\\r\\n\\r\\napp.listen(config.port, () => {\\r\\n  console.info(`The server is running at http://localhost:${config.port}/`);\\r\\n});\\r\\nexport default app;\",\"module.exports = require(\\\"@babel/polyfill/noConflict\\\");\"]}","code":"require(\"source-map-support\").install(),function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,\"__esModule\",{value:!0})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p=\"/client/\",t(t.s=10)}([function(e,r){e.exports=require(\"express-jwt\")},function(e,r){e.exports=require(\"body-parser\")},function(e,r){e.exports=require(\"express\")},function(e,r){e.exports=require(\"compression\")},function(e,r){e.exports=require(\"helmet\")},function(e,r){e.exports=require(\"pretty-error\")},function(e,r){e.exports=require(\"cookie-parser\")},function(e,r){e.exports=require(\"path\")},function(e,r,t){\"use strict\";t.r(r);var n=t(7),o=t.n(n),s=t(2),i=t.n(s),c=t(6),u=t.n(c),p=t(1),a=t.n(p),l=t(0),f=t.n(l),d=t(5),x=t.n(d);var _=process.env.PORT||8e3,v={port:_,api:{clientUrl:process.env.API_CLIENT_URL||\"\",serverUrl:process.env.API_SERVER_URL||\"http://localhost:\".concat(_)},databaseUrl:process.env.DATABASE_URL||\"localhost:27017\",auth:{jwt:{secret:process.env.JWT_SECRET||\"No secrets from you\"}}},h=t(4),k=t.n(h),q=t(3),b=t.n(q),j=i()();j.use(u()()),j.use(a.a.urlencoded({extended:!0})),j.use(a.a.json()),j.use(k()()),j.use(b()()),j.use(f()({secret:v.auth.jwt.secret,credentialsRequired:!1,getToken:function(e){return e.cookies.id_token}})),j.use(function(e,r,t,n){e instanceof l.UnauthorizedError&&(console.error(\"[express-jwt-error]\",r.cookies.id_token),t.clearCookie(\"id_token\")),n(e)}),j.use(\"/client\",i.a.static(o.a.join(__dirname,\"/public\"))),j.get(\"/\",function(e,r){r.redirect(\"/client\")});var y=new x.a;y.skipNodeFiles(),y.skipPackage(\"express\"),j.listen(v.port,function(){console.info(\"The server is running at http://localhost:\".concat(v.port,\"/\"))});r.default=j},function(e,r){e.exports=require(\"@babel/polyfill/noConflict\")},function(e,r,t){t(9),e.exports=t(8)}]);","extractedComments":[]}